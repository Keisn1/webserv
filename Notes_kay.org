#+title: Notes Kay

- [X] have a complete Equal check function of ServerConfig

- [X] all of the tests probably fit into maximum of 2 tests (those which throw error and those where you test for equalness)
- [X] the same for test_config_ast.cpp and test_config_events.cpp

- [X] Naming
  - [X] test_Router.cpp (not test_http_routing)

  - [X] ValidationRules sounds like a struct but not like a class
    - [X] what is it supposed to do (why is it not requestValidator?)

- [X] why is there a buildAST function in the tests (why is getAst public in the parser? If nobody is supposed to use it?)

- [X] the CommonConfig constructor is needless

- [X] why does the router match return the host (which is actually part of the request)?

- [X] the Router is not concerned with which port the request came from. Somebody is responsible of choosing the right Router for the port
* TODO
** overall
- [ ] build the server with the config and the Router
** listener
- [ ] implement TimeoutMechanism (stale connections, connections that are kept open after receiving a response)
- [ ] ioNotifier.wait fills up multiples descriptors and notifications
** connection Handling (architecture)
- [ ] BrokenConnection just removes the connection
  - [ ] check how ClientHungUp affects the behavior
- [ ] probably change IHandler handle interface (add ConnectionInfo to it)
- [ ] check UploadHandler behavior of sending the response

* notes configuration
- [X] change throwing of std::runtime_error to something that makes sense
- [X] no error is thrown when there is no ";" in
  #+begin_src conf
index       index.html index.htm
  #+end_src
- [X] cgi - only on location level
- [X] oneMB as default if clientMaxBody is not set
- [X] talk to Eric about oneMB const
- [X] restrict config allowedMethods to GET, POST, DELETE
- [X] insert Routing
- [ ] make reset public on HttpParser
- [ ] normalization of uri needs to be done before routing
- [ ] test for requests with longer bodies
  - [ ] test for overlapping headers and body
  - [ ] make the read and send methods adjustable in buffer size
  - [ ] rename to _headersBuf and _bodyBuf
  - [ ] test for long responses where sent needs to happen more than once
- [ ] handle ClientHungUp
* Uploadhandler
** TODO
1. [ ] don't upload to same file simultaneously
2. [ ] only reply with a response once!
3. [ ] don't remove file (test for broken connection basically)

** headers
1. Transfer-Encoding and Content-Length
   - If no Content-Length, then Transfer-Encoding needs to be chunked (and only chunked)
   - if no Transfer-encoding, then Content-Length needs to be set
2.
* httpParser
- [ ] validation Accept to rigid
- [ ] validation Accept-encoding to rigid
